(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[125],{5235:function(e,t,a){Promise.resolve().then(a.bind(a,961))},961:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return s}});var n=a(7437),d=a(2265);function s(e){let{params:t}=e,a=t.id,[s,i]=(0,d.useState)(null),[r,c]=(0,d.useState)(!1);async function l(){let e=await fetch("/api/contracts/".concat(a));i(await e.json())}(0,d.useEffect)(()=>{l()},[a]);let o=(0,d.useMemo)(()=>{if(!s)return[];let e=s.contract.start_date;return[...Array(12)].map((t,a)=>({idx:a+1,label:new Date(function(e,t){let a=new Date(e);return a.setMonth(a.getMonth()+t),a.toISOString().slice(0,10)}(e,a)).toLocaleDateString("pt-BR",{month:"short"})}))},[s]);async function x(e,t,n){c(!0),await fetch("/api/contracts/".concat(a,"/plan"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_id:e,month_index:t,date:n})}),await l(),c(!1)}return s?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("h1",{className:"text-2xl font-semibold",children:["Planner do Contrato #",s.contract.id]}),(0,n.jsx)("div",{className:"card",children:(0,n.jsxs)("div",{className:"grid md:grid-cols-4 gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"hdr",children:"Cliente"}),(0,n.jsx)("div",{children:s.company.nome})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"hdr",children:"In\xedcio"}),(0,n.jsx)("div",{children:s.contract.start_date})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"hdr",children:"T\xe9rmino"}),(0,n.jsx)("div",{children:s.contract.end_date||"—"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"hdr",children:"Valor mensal"}),(0,n.jsx)("div",{children:s.contract.monthly_value?"R$ ".concat(Number(s.contract.monthly_value).toFixed(2)):"—"})]})]})}),(0,n.jsxs)("div",{className:"card overflow-auto",children:[(0,n.jsxs)("div",{className:"grid",style:{gridTemplateColumns:"220px 220px 180px repeat(".concat(o.length,", 180px)")},children:[(0,n.jsx)("div",{className:"hdr p-2",children:"ITEM"}),(0,n.jsx)("div",{className:"hdr p-2",children:"SERVI\xc7OS CONTRATADOS"}),(0,n.jsx)("div",{className:"hdr p-2",children:"QUANTIDADE PROPOSTA"}),o.map(e=>(0,n.jsxs)("div",{className:"hdr p-2 text-center",children:[e.label.toUpperCase(),(0,n.jsx)("div",{className:"text-[10px] text-gray-400",children:"PREVIS\xc3O / DIAS"})]},e.idx)),s.items.map(e=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"border rounded-xl p-2",children:e.item_index}),(0,n.jsx)("div",{className:"border rounded-xl p-2",children:e.service_name}),(0,n.jsx)("div",{className:"border rounded-xl p-2",children:e.quantity_proposta}),o.map(t=>{var a;let d=s.grid[e.id]&&s.grid[e.id][t.idx]||null,i=(null==d?void 0:d.date)||"",r=null!==(a=null==d?void 0:d.days_to_action)&&void 0!==a?a:null;return(0,n.jsxs)("div",{className:"border rounded-xl p-2",children:[(0,n.jsx)("input",{className:"date",type:"date",value:i,onChange:a=>x(e.id,t.idx,a.target.value)}),(0,n.jsx)("div",{className:"text-xs mt-1 ".concat("number"==typeof r&&r<0?"text-red-600":"text-gray-500"),children:i?"".concat(r," dia(s)"):"Sem Atividade Lan\xe7ada"})]},t.idx)})]}))]}),r&&(0,n.jsx)("div",{className:"text-sm text-gray-500 mt-2",children:"Salvando..."})]})]}):(0,n.jsx)("div",{children:"Carregando..."})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=5235)}),_N_E=e.O()}]);