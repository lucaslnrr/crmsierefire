(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[913],{4924:function(e,t,a){Promise.resolve().then(a.bind(a,4139))},4139:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return r}});var s=a(7437),n=a(2265),i=a(231),l=a.n(i);function r(){let[e,t]=(0,n.useState)([]),[a,i]=(0,n.useState)([]),[r,c]=(0,n.useState)([]),[d,o]=(0,n.useState)({company_id:"",start_date:"",end_date:"",monthly_value:"",notes:"",items:[{service_id:"",quantity_proposta:1}]});async function h(){let[e,a,s]=await Promise.all([fetch("/api/companies").then(e=>e.json()),fetch("/api/services").then(e=>e.json()),fetch("/api/contracts").then(e=>e.json())]);i(e),c(a),t(s)}function u(e,t,a){let s=[...d.items];s[e][t]=a,o({...d,items:s})}async function m(e){e.preventDefault(),await fetch("/api/contracts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),o({company_id:"",start_date:"",end_date:"",monthly_value:"",notes:"",items:[{service_id:"",quantity_proposta:1}]}),h()}return(0,n.useEffect)(()=>{h()},[]),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold",children:"Contratos"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("form",{onSubmit:m,className:"space-y-3",children:[(0,s.jsxs)("div",{className:"grid md:grid-cols-4 gap-3",children:[(0,s.jsxs)("select",{className:"select",value:d.company_id,onChange:e=>o({...d,company_id:e.target.value}),required:!0,children:[(0,s.jsx)("option",{value:"",children:"Empresa"}),a.map(e=>(0,s.jsx)("option",{value:e.id,children:e.nome},e.id))]}),(0,s.jsx)("input",{className:"input",type:"date",value:d.start_date,onChange:e=>o({...d,start_date:e.target.value}),required:!0}),(0,s.jsx)("input",{className:"input",type:"date",value:d.end_date,onChange:e=>o({...d,end_date:e.target.value})}),(0,s.jsx)("input",{className:"input",placeholder:"Valor mensal (R$)",value:d.monthly_value,onChange:e=>o({...d,monthly_value:e.target.value})})]}),(0,s.jsx)("textarea",{className:"textarea",placeholder:"Observa\xe7\xf5es",value:d.notes,onChange:e=>o({...d,notes:e.target.value})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Servi\xe7os"}),d.items.map((e,t)=>(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-2",children:[(0,s.jsxs)("select",{className:"select",value:e.service_id,onChange:e=>u(t,"service_id",e.target.value),required:!0,children:[(0,s.jsx)("option",{value:"",children:"Servi\xe7o"}),r.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsx)("input",{className:"input",type:"number",min:"1",value:e.quantity_proposta,onChange:e=>u(t,"quantity_proposta",e.target.value)})]},t)),(0,s.jsx)("button",{type:"button",className:"btn",onClick:function(){o({...d,items:[...d.items,{service_id:"",quantity_proposta:1}]})},children:"+ Servi\xe7o"})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{className:"btn",children:"Salvar Contrato"})})]})}),(0,s.jsx)("div",{className:"card overflow-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"ID"}),(0,s.jsx)("th",{children:"Empresa"}),(0,s.jsx)("th",{children:"In\xedcio"}),(0,s.jsx)("th",{children:"T\xe9rmino"}),(0,s.jsx)("th",{children:"Valor Mensal"}),(0,s.jsx)("th",{children:"Status"}),(0,s.jsx)("th",{children:"Planner"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"border-t",children:[(0,s.jsx)("td",{children:e.id}),(0,s.jsx)("td",{children:e.company_nome}),(0,s.jsx)("td",{children:e.start_date}),(0,s.jsx)("td",{children:e.end_date||"—"}),(0,s.jsx)("td",{children:e.monthly_value?"R$ ".concat(Number(e.monthly_value).toFixed(2)):"—"}),(0,s.jsx)("td",{children:e.status}),(0,s.jsx)("td",{children:(0,s.jsx)(l(),{className:"btn",href:"/contracts/".concat(e.id,"/planner"),children:"Abrir"})})]},e.id))})]})})]})}}},function(e){e.O(0,[231,971,23,744],function(){return e(e.s=4924)}),_N_E=e.O()}]);