(()=>{var e={};e.id=628,e.ids=[628],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},56835:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>h,tree:()=>d}),t(74465),t(68295),t(35866);var a=t(23191),r=t(88716),i=t(37922),n=t.n(i),o=t(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(s,l);let d=["",{children:["proposals",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,74465)),"C:\\Users\\felipe\\Desktop\\agora\\src\\app\\proposals\\page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,68295)),"C:\\Users\\felipe\\Desktop\\agora\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\felipe\\Desktop\\agora\\src\\app\\proposals\\page.jsx"],p="/proposals/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/proposals/page",pathname:"/proposals",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},84208:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},41339:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,79404,23))},63812:(e,s,t)=>{Promise.resolve().then(t.bind(t,81303))},81303:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(10326),r=t(17577);function i(){let[e,s]=(0,r.useState)([]),[t,i]=(0,r.useState)([]),[n,o]=(0,r.useState)([]),[l,d]=(0,r.useState)({company_id:"",description:"",value:"",items:[{service_id:"",qty:1,price:"",due_date:""}]});async function c(){let[e,t,a]=await Promise.all([fetch("/api/companies").then(e=>e.json()),fetch("/api/services").then(e=>e.json()),fetch("/api/proposals").then(e=>e.json())]);s(e),i(t),o(a)}function p(e,s,t){let a=[...l.items];a[e][s]=t,d({...l,items:a})}async function u(e){e.preventDefault(),await fetch("/api/proposals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),d({company_id:"",description:"",value:"",items:[{service_id:"",qty:1,price:"",due_date:""}]}),c()}async function h(e){await fetch("/api/proposals/"+e,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"APROVADA"})}),c()}return(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("h1",{className:"text-2xl font-semibold",children:"Propostas"}),a.jsx("div",{className:"card",children:(0,a.jsxs)("form",{onSubmit:u,className:"space-y-3",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-3",children:[(0,a.jsxs)("select",{className:"select",value:l.company_id,onChange:e=>d({...l,company_id:e.target.value}),required:!0,children:[a.jsx("option",{value:"",children:"Empresa"}),e.map(e=>a.jsx("option",{value:e.id,children:e.nome},e.id))]}),a.jsx("input",{className:"input",placeholder:"Valor total (R$)",value:l.value,onChange:e=>d({...l,value:e.target.value})}),a.jsx("input",{className:"input",placeholder:"Descri\xe7\xe3o",value:l.description,onChange:e=>d({...l,description:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm font-medium",children:"Itens"}),l.items.map((e,s)=>(0,a.jsxs)("div",{className:"grid md:grid-cols-4 gap-2",children:[(0,a.jsxs)("select",{className:"select",value:e.service_id,onChange:e=>p(s,"service_id",e.target.value),required:!0,children:[a.jsx("option",{value:"",children:"Servi\xe7o"}),t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]}),a.jsx("input",{className:"input",type:"number",min:"1",value:e.qty,onChange:e=>p(s,"qty",e.target.value)}),a.jsx("input",{className:"input",placeholder:"Pre\xe7o (R$)",value:e.price,onChange:e=>p(s,"price",e.target.value)}),a.jsx("input",{className:"input",type:"date",value:e.due_date||"",onChange:e=>p(s,"due_date",e.target.value)})]},s)),a.jsx("button",{type:"button",className:"btn",onClick:function(){d({...l,items:[...l.items,{service_id:"",qty:1,price:"",due_date:""}]})},children:"+ Item"})]}),a.jsx("div",{children:a.jsx("button",{className:"btn",children:"Salvar Proposta"})})]})}),a.jsx("div",{className:"card overflow-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{children:[a.jsx("th",{children:"ID"}),a.jsx("th",{children:"Empresa"}),a.jsx("th",{children:"Valor"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Emitida"}),a.jsx("th",{children:"A\xe7\xf5es"})]})}),a.jsx("tbody",{children:n.map(e=>(0,a.jsxs)("tr",{className:"border-t",children:[a.jsx("td",{children:e.id}),a.jsx("td",{children:e.company_nome}),(0,a.jsxs)("td",{children:["R$ ",Number(e.value).toFixed(2)]}),a.jsx("td",{children:e.status}),a.jsx("td",{children:new Date(e.issued_at).toLocaleString("pt-BR")}),a.jsx("td",{children:"APROVADA"!==e.status&&a.jsx("button",{className:"btn",onClick:()=>h(e.id),children:"Aprovar"})})]},e.id))})]})})]})}},68295:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n,metadata:()=>i});var a=t(19510);t(5023);var r=t(57371);let i={title:"Propostas & Atividades",description:"Controle de propostas, contratos e agenda"};function n({children:e}){return a.jsx("html",{lang:"pt-BR",children:(0,a.jsxs)("body",{children:[a.jsx("nav",{className:"bg-white border-b border-gray-200",children:(0,a.jsxs)("div",{className:"container h-14 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx(r.default,{href:"/dashboard",children:"Dashboard"}),a.jsx(r.default,{href:"/calendar",children:"Calend\xe1rio"}),a.jsx(r.default,{href:"/companies",children:"Empresas"}),a.jsx(r.default,{href:"/proposals",children:"Propostas"}),a.jsx(r.default,{href:"/contracts",children:"Contratos"})]}),a.jsx("form",{action:"/api/auth/logout",method:"post",children:a.jsx("button",{className:"text-sm text-red-600",children:"Sair"})})]})}),a.jsx("main",{className:"container py-6",children:e})]})})}},74465:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`C:\Users\felipe\Desktop\agora\src\app\proposals\page.jsx#default`)},5023:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[948,707],()=>t(56835));module.exports=a})();