(()=>{var e={};e.id=262,e.ids=[262],e.modules={62849:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=62849,e.exports=t},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},41808:e=>{"use strict";e.exports=require("net")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},39512:e=>{"use strict";e.exports=require("timers")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},17594:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>v,requestAsyncStorage:()=>E,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>_});var s={};r.r(s),r.d(s,{GET:()=>l,dynamic:()=>u,runtime:()=>c});var i=r(49303),a=r(88716),n=r(60670),o=r(16385);let c="nodejs",u="force-dynamic";function p(e){return e instanceof Date?e:new Date(e)}function d(e){let t=p(e);if(!t||isNaN(t))return"";let r=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${s}-${i}`}async function l(e,{params:t}){let r=Number(t.id),s=await (0,o.V)(),[[i]]=await s.execute("SELECT * FROM contracts WHERE id=?",[r]),[[a]]=await s.execute("SELECT * FROM companies WHERE id=?",[i.company_id]),[n]=await s.execute("SELECT ci.*, s.name as service_name FROM contract_items ci JOIN services s ON s.id=ci.service_id WHERE ci.contract_id=? ORDER BY ci.id",[r]),c=[];if(n.length){let e=n.map(e=>e.id),t=e.map(()=>"?").join(","),[r]=await s.execute(`SELECT * FROM activities WHERE created_from='CONTRATO' AND related_id IN (${t})`,e);c=r}await s.end();let u=d(new Date),l={};return n.forEach(e=>l[e.id]={}),c.forEach(e=>{let t=function(e,t){let r=p(e),s=p(t);return(s.getFullYear()-r.getFullYear())*12+(s.getMonth()-r.getMonth())+1}(i.start_date,e.start_datetime);if(t>=1&&t<=12){let r=d(e.start_datetime),s=function(e,t){let r=p(e),s=p(t),i=new Date(r.getFullYear(),r.getMonth(),r.getDate());return Math.round((new Date(s.getFullYear(),s.getMonth(),s.getDate())-i)/864e5)}(u,r);l[e.related_id][t]={date:r,days_to_action:s}}}),n.forEach(e=>{for(let t=1;t<=12;t++)l[e.id][t]||(l[e.id][t]={date:"",days_to_action:null})}),new Response(JSON.stringify({contract:i,company:a,items:n.map((e,t)=>({...e,item_index:t+1})),grid:l}),{headers:{"Content-Type":"application/json"}})}let m=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/contracts/[id]/route",pathname:"/api/contracts/[id]",filename:"route",bundlePath:"app/api/contracts/[id]/route"},resolvedPagePath:"C:\\Users\\felipe\\Desktop\\agora\\src\\app\\api\\contracts\\[id]\\route.js",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:E,staticGenerationAsyncStorage:_,serverHooks:f}=m,g="/api/contracts/[id]/route";function v(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:_})}},49303:(e,t,r)=>{"use strict";e.exports=r(30517)},16385:(e,t,r)=>{"use strict";r.d(t,{V:()=>i});var s=r(69518);async function i(){if(!process.env.DB_HOST||!process.env.DB_USER||!process.env.DB_NAME)throw Error("Database env vars missing (DB_HOST, DB_USER, DB_NAME). Configure on Vercel Project Settings â†’ Environment Variables.");return await s.createConnection({host:process.env.DB_HOST,port:process.env.DB_PORT||3306,user:process.env.DB_USER,password:process.env.DB_PASS,database:process.env.DB_NAME,charset:"utf8mb4"})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,827],()=>r(17594));module.exports=s})();