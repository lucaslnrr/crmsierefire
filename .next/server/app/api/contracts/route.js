(()=>{var e={};e.id=326,e.ids=[326],e.modules={62849:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=62849,e.exports=t},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},41808:e=>{"use strict";e.exports=require("net")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},39512:e=>{"use strict";e.exports=require("timers")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},83983:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>E,patchFetch:()=>x,requestAsyncStorage:()=>_,routeModule:()=>l,serverHooks:()=>v,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{GET:()=>p,POST:()=>d,dynamic:()=>u,runtime:()=>c});var i=r(49303),a=r(88716),o=r(60670),n=r(16385);let c="nodejs",u="force-dynamic";async function p(){let e=await (0,n.V)(),[t]=await e.execute("SELECT ct.*, c.nome as company_nome FROM contracts ct JOIN companies c ON c.id=ct.company_id ORDER BY ct.id DESC");return await e.end(),new Response(JSON.stringify(t),{headers:{"Content-Type":"application/json"}})}async function d(e){let t=await e.json(),r=await (0,n.V)(),[s]=await r.execute("INSERT INTO contracts (company_id, proposal_id, start_date, end_date, monthly_value, status, notes) VALUES (?,?,?,?,?,'ATIVO',?)",[t.company_id,t.proposal_id||null,t.start_date,t.end_date||null,t.monthly_value||null,t.notes||null]),i=s.insertId;if(Array.isArray(t.items))for(let e of t.items){if(!e.service_id)continue;let[s]=await r.execute("INSERT INTO contract_items (contract_id, service_id, quantity_proposta) VALUES (?,?,?)",[i,e.service_id,e.quantity_proposta||1]),a=`${t.start_date} 09:00:00`,[[o]]=await r.execute("SELECT name FROM services WHERE id=?",[e.service_id]);await r.execute("INSERT INTO activities (title, company_id, service_id, assigned_user_id, start_datetime, status, created_from, related_id) VALUES (?,?,?,?,?, 'PENDENTE','CONTRATO',?)",[`${o?.name||"Servi\xe7o"} — Contrato #${i}`,t.company_id,e.service_id,null,a,s.insertId])}return await r.end(),new Response(JSON.stringify({ok:!0,id:i}),{headers:{"Content-Type":"application/json"}})}let l=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/contracts/route",pathname:"/api/contracts",filename:"route",bundlePath:"app/api/contracts/route"},resolvedPagePath:"C:\\Users\\felipe\\Desktop\\agora\\src\\app\\api\\contracts\\route.js",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:_,staticGenerationAsyncStorage:m,serverHooks:v}=l,E="/api/contracts/route";function x(){return(0,o.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:m})}},49303:(e,t,r)=>{"use strict";e.exports=r(30517)},16385:(e,t,r)=>{"use strict";r.d(t,{V:()=>i});var s=r(69518);async function i(){if(!process.env.DB_HOST||!process.env.DB_USER||!process.env.DB_NAME)throw Error("Database env vars missing (DB_HOST, DB_USER, DB_NAME). Configure on Vercel Project Settings → Environment Variables.");return await s.createConnection({host:process.env.DB_HOST,port:process.env.DB_PORT||3306,user:process.env.DB_USER,password:process.env.DB_PASS,database:process.env.DB_NAME,charset:"utf8mb4"})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,827],()=>r(83983));module.exports=s})();